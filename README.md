Code for "Counterfactual Dynamics Forecasting - A New Setting of Quantitative Reasoning".

## Generate dataset
Datasets BouncingPointMasses and ChainPendulumWithContact can be generated by ```datasets/datasets.py``` or can be downloaded from ```datasets/data.zip```.

## Training

Train the counterfactual model, e.g., for BouncingPointMasses system with Type I counterfactual:
```
python trainer.py --body-class BouncingPointMasses --body-kwargs-file _BP5_cf_1 --batch-size 192
```
More parameters can be set via commands in trainer.py.

## Testing

Test the model: ```python tester.py```


### Acknowledgment
The code is modified from the implementation of "Extending Lagrangian and Hamiltonian Neural Networks with Differentiable Contact Models" (https://github.com/Physics-aware-AI/DiffCoSim/), thanks for the authors' valuable contribution and sharing. 